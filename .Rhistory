label <- create.label(meta=meta, label="Group",
case = 'H', control='NH')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
show(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
data("feat_crc_zeller", package="SIAMCAT")
data("meta_crc_zeller", package="SIAMCAT")
label.crc.zeller <- create.label(meta=meta.crc.zeller,
label='Group', case='CRC')
class
sc.obj <- siamcat(feat=feat.crc.zeller,
label=label.crc.zeller,
meta=meta.crc.zeller)
show(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance',
cutoff = 0.001)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10 ^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
show(sc.obj)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
data("feat_crc_zeller", package="SIAMCAT")
data("meta_crc_zeller", package="SIAMCAT")
label.crc.zeller <- create.label(meta=meta.crc.zeller,
label='Group', case='CRC')
sc.obj <- siamcat(feat=feat.crc.zeller,
label=label.crc.zeller,
meta=meta.crc.zeller)
show(sc.obj)
View(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance',
cutoff = 0.001)
View(sc.obj)
View(sc.obj)
show(sc.obj)
sct.obj <- siamcat(feat=df, meta=meta, label=label)
show(sct.obj)
View(sct.obj)
sct.obj <- filter.features(sct.obj,
filter.method = 'abundance'
,cutoff = 0.001)
View(sct.obj)
sc.obj <- siamcat(feat=feat.crc.zeller,
label=label.crc.zeller,
meta=meta.crc.zeller)
show(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance',
cutoff = 0.001)
View(sc.obj)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10 ^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
library("SIAMCAT")
data("feat_crc_zeller", package="SIAMCAT")
data("meta_crc_zeller", package="SIAMCAT")
label.crc.zeller <- create.label(meta=meta.crc.zeller,
label='Group', case='CRC')
sc.obj <- siamcat(feat=feat.crc.zeller,
label=label.crc.zeller,
meta=meta.crc.zeller)
show(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance',
cutoff = 0.001)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10 ^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
df = read.table('test_abundance.txt',sep='\t')
df
df$V3 <- df$V2
df$V2 <- df$V2*3
df$V4 <- df$V2*5
df$V5 <- df$V2*0.5
df$V3<- (df$V3)/(sum(df$V3))
df$V2<- (df$V2)/(sum(df$V2))
df$V4<- (df$V4)/(sum(df$V4))
df$V5<- (df$V5)/(sum(df$V5))
rownames(df) <- df$V1
df = subset(df, select = -c(V1) )
Samples <- c("V2", "V3","V4","V5")
Group <- c("H", "NH","H","NH")
meta <- data.frame(Group)
rownames(meta) <- Samples
label <- create.label(meta=meta, label="Group",
case = 'H', control='NH')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
show(sct.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
df = read.table('test_abundance.txt',sep='\t')
df
df$V3 <- df$V2
df$V2 <- df$V2*3
df$V4 <- df$V2*5
df$V5 <- df$V2*0.5
df$V3<- (df$V3)/(sum(df$V3))
df$V2<- (df$V2)/(sum(df$V2))
df$V4<- (df$V4)/(sum(df$V4))
df$V5<- (df$V5)/(sum(df$V5))
rownames(df) <- df$V1
df = subset(df, select = -c(V1) )
View(df)
df = subset(df, select = -c(V1) )
df = read.table('test_abundance.txt',sep='\t')
df
df$V3 <- df$V2
df$V2 <- df$V2*3
df$V4 <- df$V2*5
df$V5 <- df$V2*0.5
df$V3<- (df$V3)/(sum(df$V3))
df$V2<- (df$V2)/(sum(df$V2))
df$V4<- (df$V4)/(sum(df$V4))
df$V5<- (df$V5)/(sum(df$V5))
rownames(df) <- df$V1
df = subset(df, select = -c(V1) )
write.csv(df,"abundance.csv")
df = read.table('ERR1398129_gene_abundance_mght.txt',sep='\t')
View(df)
getwd()
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
df = read.table('subsystem_1.txt',sep='\t')
source("~/test_siamcat.r", echo=TRUE)
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
df = read.table('subsystem_1.txt',sep='\t')
getwd()
setwd(dirname(rstudioapi::getSourceEditorContext()$path))
getwd()
setwd("C:/Users/Jenni/Documents/GitHub/MWASHypertension")
getwd()
library("SIAMCAT")
library(phyloseq)
library(dplyr)
df = read.table('subsystem_1.txt',sep='\t')
df
df
df = df[-1,]
df = read.table('subsystem_1.txt',sep='\t')
df
rownames(df) <- df[1,]
df = read.table('subsystem_1.txt',sep='\t')
names(df) <- df[1,]
df = df[-1,]
rownames(df) <- df$`Subsystem 1`
df = df[,-1]
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
View(meta)
names(meta) <- c("Sample", "Trait")
label <- create.label(meta=meta, label="Group",
case = 'Hipertension', control='No hipertension')
label <- create.label(meta=metadata, label="Group",
case = 'Hipertension', control='No hipertension')
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Trait")
label <- create.label(meta=meta, label="Group",
case = 'Hipertension', control='No hipertension')
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Group")
label <- create.label(meta=meta, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
sc.obj <- siamcat(feat=df, meta=meta, label=label)
df = read.table('subsystem_level_1.txt',sep='\t')
names(df) = df[1,]
df = df[-1,]
rownames(df) <- df$`Subsystem 1`
df = df[,-1]
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Group")
label <- create.label(meta=meta, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
data("feat_crc_zeller", package="SIAMCAT")
data("meta_crc_zeller", package="SIAMCAT")
force(feat.crc.zeller)
View(df)
View(feat.crc.zeller)
sc.obj <- siamcat(feat=df, meta=meta, label=label)
is.numeric(df$ERR1398068)
df$ERR1398068 <- as.integer(df$ERR1398068)
is.numeric(df$ERR1398068)
df$ERR1398068 <- as.integer(df$ERR1398068)
df$ERR1398168 <- as.integer(df$ERR1398168)
df = read.table('subsystem_level_1.txt',sep='\t')
names(df) = df[1,]
df = df[-1,]
rownames(df) <- df$`Subsystem 1`
df = df[,-1]
df
df$ERR1398068 <- as.numeric(df$ERR1398068)
df$ERR1398168 <- as.numeric(df$ERR1398168)
df$ERR1398221 <- as.numeric(df$ERR1398221)
df$ERR1398129 <- as.numeric(df$ERR1398129)
df$ERR1398206 <- as.numeric(df$ERR1398206)
df$ERR1398263 <- as.numeric(df$ERR1398263)
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Group")
label <- create.label(meta=meta, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
force(meta.crc.zeller)
View(meta.crc.zeller)
rownames(meta) <- meta$Sample
meta <- meta[,-1]
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Group")
rownames(meta) <- meta$Sample
meta = meta[,-1]
rownames(meta) <- meta$Sample
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Group")
rownames(meta) <- meta$Sample
meta = meta[,-1]
#meta <- data.frame(Group)
meta <- read.table('metadata.txt',sep='\t')
names(meta) <- c("Sample", "Group")
rownames(meta) <- meta$
df = df[,-1]
rownames(meta) <- meta$Sample
meta = meta[,-1]
#meta <- data.frame(Group)
metadata <- read.table('metadata.txt',sep='\t')
names(metadata) <- c("Sample", "Group")
rownames(metadata) <- metadata$Sample
label <- create.label(meta=metadata, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
df = read.table('system_1',sep='\t')
df = read.table('subsystem_1',sep='\t')
df = read.table('subsystem_1',sep='\t')
getwd()
df = read.table('subsystem_1.txt',sep='\t')
names(df) = df[1,]
df = df[-1,]
rownames(df) <- df$`Subsystem 1`
df = df[,-1]
df
df$ERR1398068 <- as.numeric(df$ERR1398068)
df$ERR1398168 <- as.numeric(df$ERR1398168)
df$ERR1398221 <- as.numeric(df$ERR1398221)
df$ERR1398129 <- as.numeric(df$ERR1398129)
df$ERR1398206 <- as.numeric(df$ERR1398206)
df$ERR1398263 <- as.numeric(df$ERR1398263)
is.numeric(df$ERR1398068)
#meta <- data.frame(Group)
metadata <- read.table('metadata.txt',sep='\t')
names(metadata) <- c("Sample", "Group")
rownames(metadata) <- metadata$Sample
label <- create.label(meta=metadata, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
df$ERR1398068 <- (df$ERR1398068)/(sum(df$ERR1398068))
df$ERR1398068 <- (df$ERR1398068)/(sum(df$ERR1398068))
df$ERR1398168 <-  (df$ERR1398168)/(sum(df$ERR1398168))
df$ERR1398221 <-  (df$ERR1398221)/(sum(df$ERR1398221))
df$ERR1398129 <-  (df$ERR1398129)/(sum(df$ERR1398129))
df$ERR1398206 <- (df$ERR1398206)/(sum(df$ERR1398206))
df$ERR1398263 <-  (df$ERR1398263)/(sum(df$ERR1398263))
df = read.table('subsystem_1.txt',sep='\t')
names(df) = df[1,]
df = df[-1,]
rownames(df) <- df$`Subsystem 1`
df = df[,-1]
df
df$ERR1398068 <- as.numeric(df$ERR1398068)
df$ERR1398168 <- as.numeric(df$ERR1398168)
df$ERR1398221 <- as.numeric(df$ERR1398221)
df$ERR1398129 <- as.numeric(df$ERR1398129)
df$ERR1398206 <- as.numeric(df$ERR1398206)
df$ERR1398263 <- as.numeric(df$ERR1398263)
df$ERR1398068 <- (df$ERR1398068)/(sum(df$ERR1398068))
df$ERR1398168 <-  (df$ERR1398168)/(sum(df$ERR1398168))
df$ERR1398221 <-  (df$ERR1398221)/(sum(df$ERR1398221))
df$ERR1398129 <-  (df$ERR1398129)/(sum(df$ERR1398129))
df$ERR1398206 <- (df$ERR1398206)/(sum(df$ERR1398206))
df$ERR1398263 <-  (df$ERR1398263)/(sum(df$ERR1398263))
#meta <- data.frame(Group)
metadata <- read.table('metadata.txt',sep='\t')
names(metadata) <- c("Sample", "Group")
rownames(metadata) <- metadata$Sample
label <- create.label(meta=metadata, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=meta, label=label)
show(sct.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
show(sct.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
show(sct.obj)
View(sc.obj)
sc.obj <- siamcat(feat=df, meta=meta, label=label)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
feature.type = 'filtered'
)
sc.obj <- siamcat(feat=df, meta=meta, label=label)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
feature.type = 'filtered'
)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
View(metadata)
View(metadata)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- siamcat(feat=df, meta=meta, label=label)
show(sc.obj)
meta(sc.obj)
sc.obj <- siamcat(feat=df, meta=metadata, label=label)
show(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
meta(sc.obj)
sc.obj <- check.associations(
sc.obj,
sort.by = 'fc',
alpha = 0.05,
mult.corr = "fdr",
detect.lim = 10^-6,
plot.type = "quantile.box",
panels = c("fc", "prevalence", "auroc"))
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
meta(sc.obj)
View(meta.crc.zeller)
#meta <- data.frame(Group)
metadata <- read.table('metadata.txt',sep='\t')
names(metadata) <- c("Sample", "Group")
rownames(metadata) <- metadata$Sample
metadata$Sample <- NULL
label <- create.label(meta=metadata, label="Group",
case = 'Hipertension', control='No hipertension')
sc.obj <- siamcat(feat=df, meta=metadata, label=label)
show(sc.obj)
sc.obj <- filter.features(sc.obj,
filter.method = 'abundance'
,cutoff = 0.001)
sc.obj <- check.confounders(
sc.obj,
fn.plot = 'confounder_plots.pdf',
meta.in = NULL,
feature.type = 'filtered'
)
#############
sc.obj <- normalize.features(
sc.obj,
norm.method = "log.unit",
norm.param = list(
log.n0 = 1e-06,
n.p = 2,
norm.margin = 1
)
)
sc.obj <-  create.data.split(
sc.obj,
num.folds = 5,
num.resample = 2
)
sc.obj <- train.model(
sc.obj,
method = "lasso"
)
sc.obj <-  create.data.split(
sc.obj,
num.folds = 5,
num.resample = 1
)
sc.obj <-  create.data.split(
sc.obj,
num.folds = 2,
num.resample = 1
)
